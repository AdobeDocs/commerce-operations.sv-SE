---
title: 'ACSD-68356: [!DNL GraphQL] kundvagnsfrågan returnerar felaktigt rabattbelopp för virtuella offerter'
description: 'Använd patchen ACSD-68356 för att åtgärda Adobe Commerce-problemet där kundvagnsfrågan returnerar felaktigt rabattbelopp för virtuella offerter. [!DNL GraphQL] '
feature: Shopping Cart, GraphQL
role: Admin, Developer
type: Troubleshooting
source-git-commit: de86326804ad0d27b3580d9cede964a59bfa77fe
workflow-type: tm+mt
source-wordcount: '338'
ht-degree: 0%

---

# ACSD-68356: [!DNL GraphQL] kundvagnsfrågan returnerar felaktigt rabattbelopp för virtuella offerter

Korrigeringen ACSD-68356 åtgärdar ett problem där kundvagnsfrågan [!DNL GraphQL] returnerar ett felaktigt rabattbelopp för virtuella offerter. Den här korrigeringen är tillgänglig när [[!DNL Quality Patches Tool (QPT)]](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) 1.1.73 har installerats. Korrigerings-ID är ACSD-68356. Observera att problemet är planerat att åtgärdas i Adobe Commerce 2.4.9.

## Berörda produkter och versioner

**Korrigeringen har skapats för Adobe Commerce-version:**

* Adobe Commerce (alla distributionsmetoder) 2.4.8-p2

**Kompatibel med Adobe Commerce-versioner:**

* Adobe Commerce (alla distributionsmetoder) 2.4.8 - 2.4.8-p3

>[!NOTE]
>
>Korrigeringen kan bli tillämplig för andra versioner med nya [!DNL Quality Patches Tool]-versioner. Om du vill kontrollera om korrigeringen är kompatibel med din Adobe Commerce-version uppdaterar du `magento/quality-patches`-paketet till den senaste versionen och kontrollerar kompatibiliteten på [[!DNL Quality Patches Tool]: Sök efter korrigeringsfiler &#x200B;](https://experienceleague.adobe.com/tools/commerce-quality-patches/index.html?lang=sv-SE). Använd patch-ID:t som söknyckelord för att hitta patchen.

## Problem

[!DNL GraphQL] kundvagnsfrågor returnerar felaktiga rabattbelopp för virtuella offerter, vilket ger rabatter för ej berättigade virtuella produkter.

<u>Steg som ska återskapas</u>:

1. Skapa två virtuella produkter:
   1. `virtual1` SKU
   1. `virtual2` SKU
1. Skapa en kundvagnsprisregel:
   1. Anges att gälla automatiskt, utan kupong.
   1. Funktionsmakron:
   1. Procent av produktprisrabatt - 20 %.
   1. Gäller endast varukorgsobjekt där SKU är `virtual2`.
1. Lägg till produkter i en ny, tom offert via storefront:
   1. Lägg till `virtual1` SKU först.
   1. Lägg till `virtual2` SKU-sekund.
1. Hämta kundvagnsinformation med följande [!DNL GraphQL]-fråga:

   ```
   {
     cart(cart_id: "cart_id") {
       email
       itemsV2 {
         total_count
         items {
           uid
           prices {
             total_item_discount {
               value
             }
             price {
               value
             }
             discounts {
               label
               amount {
                 value
               }
             }
           }
           product {
             name
             sku
           }
           quantity
         },
         page_info {
             page_size
             current_page
             total_pages
         }
       }
       applied_coupons {
         code
       }
       prices {
         discounts {
           amount {
             value
           }
           applied_to
           label
         }
         grand_total {
           value
         }
       }
     }
   }
   ```

1. Kontrollera **[!UICONTROL cart]** > **[!UICONTROL items]** > **[!UICONTROL prices]** > **[!UICONTROL discounts]**.

<u>Förväntade resultat</u>:

* `virtual1` SKU har ingen rabatt angiven i [!DNL GraphQL]
* `virtual2` SKU har rabatt i [!DNL GraphQL]

<u>Faktiska resultat</u>:

* `virtual1` och `virtual2` visar felaktigt samma rabattbelopp i svaret på [!DNL GraphQL].

## Tillämpa korrigeringen

Använd följande länkar beroende på distributionsmetod för att tillämpa enskilda korrigeringsfiler:

* Lokal användning för Adobe Commerce eller Magento Open Source: [[!DNL Quality Patches Tool] > Användning &#x200B;](/help/tools/quality-patches-tool/usage.md) i guiden [!DNL Quality Patches Tool].
* Adobe Commerce om molninfrastruktur: [Uppgraderingar och korrigeringar > Tillämpa korrigeringar](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/upgrade/apply-patches.html?lang=sv-SE) i Commerce om molninfrastruktur.

## Relaterad läsning

Mer information om [!DNL Quality Patches Tool] finns i:

* [[!DNL Quality Patches Tool]: Ett självbetjäningsverktyg för kvalitetspatchar](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) i verktygshandboken.
