---
title: 'ACSD-68190: Rabatterna tillämpas inte korrekt och tas bort efter kupongborttagning i kundvagnsvyn i GraphQL'
description: Använd patchen ACSD-68190 för att lösa ett problem där "removeCouponFromCart" tar bort alla rabatter, inklusive icke-kupongrabatter, i stället för endast kupongrabatt.
feature: GraphQL, Checkout, Price Rules
role: Admin, Developer
type: Troubleshooting
source-git-commit: 6001c9c04ea198697ad3aea19bef24cd4576f6f1
workflow-type: tm+mt
source-wordcount: '429'
ht-degree: 0%

---


# ACSD-68190: Rabatterna tillämpas inte korrekt och tas bort efter kupongborttagning i kundvagnsvyn för [!DNL GraphQL]

Korrigeringen ACSD-68190 åtgärdar ett problem där rabatter inte gäller, tillämpade rabatter inte visas korrekt i kundvagnssvaret på [!DNL GraphQL] och icke-kupongrabatter tas bort när kupongrabatt tas bort. Den här korrigeringen är tillgänglig när [[!DNL Quality Patches Tool (QPT)]](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) 1.1.73 har installerats. Korrigerings-ID är ACSD-68190. Observera att problemet är planerat att åtgärdas i Adobe Commerce 2.4.8.

## Berörda produkter och versioner

**Korrigeringen har skapats för Adobe Commerce-version:**

* Adobe Commerce (alla distributionsmetoder) 2.4.6-p3

**Kompatibel med Adobe Commerce-versioner:**

* Adobe Commerce (alla distributionsmetoder) 2.4.4 - 2.4.6-p13

>[!NOTE]
>
>Korrigeringen kan bli tillämplig för andra versioner med nya [!DNL Quality Patches Tool]-versioner. Om du vill kontrollera om korrigeringen är kompatibel med din Adobe Commerce-version uppdaterar du `magento/quality-patches`-paketet till den senaste versionen och kontrollerar kompatibiliteten på [[!DNL Quality Patches Tool]: Sök efter korrigeringsfiler &#x200B;](https://experienceleague.adobe.com/tools/commerce-quality-patches/index.html?lang=sv-SE). Använd patch-ID:t som söknyckelord för att hitta patchen.

## Problem

Rabatterna gäller inte, de tillämpade rabatterna visas inte korrekt i kundvagnssvaret på [!DNL GraphQL] och rabatter som inte är kuponger tas bort när kupongrabatten tas bort.

<u>Steg som ska återskapas</u>:

1. Skapa följande kategoriträd:
   1. Ny rotkategori
      1. kategori1 
         1. underkategori 1.1
1. Gå till **[!UICONTROL Stores]** > **[!UICONTROL Stores]** och tilldela den nya rotkategorin till din butik.
1. Skapa en ny produkt och tilldela den till kategori1.
1. Skapa regel1 för kategori1 (ingen kupong krävs).
1. Ange &quot;Ignorera efterföljande regler&quot; = NO.
1. Skapa regel 2 (särskild kupong krävs).
1. Ange &quot;Ignorera efterföljande regler&quot; = NO
1. Skapa en kund.
1. Använd [!DNL GraphQL] för att hämta kundtoken.
1. Lägg till produkt i kundvagn med [!DNL GraphQL].
1. Kontrollera att regel1 (ej kupongrabatt) inte används från början.
1. Använd kupong med [!DNL GraphQL] `applyCouponToCart`-mutation.
1. Kontrollera att både regel1- och regel2-rabatterna nu används.
1. Ta bort kupong med [!DNL GraphQL] `removeCouponFromCart`-mutation.

<u>Förväntade resultat</u>:

Endast kupongrabatten ska tas bort. Rabatter som inte är kupongrabatter ska behållas.
Icke-kupongrabatter (regel 1) ska fortsätta att gälla i kundvagnen.

<u>Faktiska resultat</u>:

Alla rabatter tas bort när removeCouponFromCart används.
I kundvagnssvaret visas inga rabatter, även om rabatter som inte är kuponger fortfarande ska vara aktiva.

## Tillämpa korrigeringen

Använd följande länkar beroende på distributionsmetod för att tillämpa enskilda korrigeringsfiler:

* Lokal användning för Adobe Commerce eller Magento Open Source: [[!DNL Quality Patches Tool] > Användning &#x200B;](/help/tools/quality-patches-tool/usage.md) i guiden [!DNL Quality Patches Tool].
* Adobe Commerce om molninfrastruktur: [Uppgraderingar och korrigeringar > Tillämpa korrigeringar](https://experienceleague.adobe.com/docs/commerce-cloud-service/user-guide/develop/upgrade/apply-patches.html?lang=sv-SE) i Commerce om molninfrastruktur.

## Relaterad läsning

Mer information om [!DNL Quality Patches Tool] finns i:

* [[!DNL Quality Patches Tool]: Ett självbetjäningsverktyg för kvalitetspatchar](/help/tools/quality-patches-tool/quality-patches-tool-to-self-serve-quality-patches.md) i verktygshandboken.
